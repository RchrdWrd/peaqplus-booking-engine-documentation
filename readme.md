![My Image](data:image/png;base64,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)

# Booking Engine API Documentation

## Language Selection / Nyelv V√°laszt√°s

- [üá¨üáß English Documentation](#english-documentation)
- [üá≠üá∫ Magyar Dokument√°ci√≥](#magyar-dokument√°ci√≥)

---

## English Documentation

### Overview
The Booking Engine API provides endpoints for recording search activities in hotel booking systems. This API helps track user search behavior for analytics and reporting purposes.

### Base URL
```
https://peaqplus.com/api
```

### Authentication
All requests require proper third-party token authentication in the header:
```
X-Third-Party-Token: YOUR_THIRD_PARTY_TOKEN
```

The middleware validates the token and automatically extracts subhotel_id and third-party information from the token. The system also performs URL validation if enabled for the third party.

---

### POST /booking-engine-search

Records search activities in the booking engine system for analytics and tracking purposes.

#### Endpoint
```
POST /api/booking-engine-search
```

#### Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `date_from` | string | Yes | Check-in date in YYYY-MM-DD format |
| `date_to` | string | Yes | Check-out date in YYYY-MM-DD format (must be after or equal to date_from) |

#### Request Example
```json
{
  "date_from": "2025-06-01",
  "date_to": "2025-06-05"
}
```

#### Response Format

##### Success Response (200 OK)
```json
{
  "success": true,
  "message": "Booking engine search recorded successfully",
  "data": {
    "days_recorded": 4,
    "subhotel_id": 123,
    "date_from": "2025-06-01",
    "date_to": "2025-06-05"
  }
}
```

##### Error Responses

**Authentication Error (401 Unauthorized)**
```json
{
  "success": false,
  "message": "Third party token is missing"
}
```

**Invalid Token (401 Unauthorized)**
```json
{
  "success": false,
  "message": "Invalid third party token"
}
```

**URL Validation Error (401 Unauthorized)**
```json
{
  "success": false,
  "message": "URL validation failed: missing referer or origin"
}
```

**Validation Error (422 Unprocessable Entity)**
```json
{
  "success": false,
  "message": "The given data was invalid.",
  "errors": {
    "date_from": ["The date from field is required."],
    "date_to": ["The date to must be a date after or equal to date from."]
  }
}
```

**Missing Subhotel ID (400 Bad Request)**
```json
{
  "success": false,
  "message": "Invalid subhotel_id"
}
```

**Server Error (500 Internal Server Error)**
```json
{
  "success": false,
  "message": "Error processing booking engine search",
  "error": "Database connection failed"
}
```

---

### POST /test/booking-engine-search

Test endpoint that mimics the search recording functionality without saving data to the database. Used for testing and development purposes.

#### Endpoint
```
POST /api/test/booking-engine-search
```

#### Request Parameters

| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `date_from` | string | Yes | Check-in date in YYYY-MM-DD format |
| `date_to` | string | Yes | Check-out date in YYYY-MM-DD format (must be after or equal to date_from) |

#### Request Example
```json
{
  "date_from": "2025-06-01",
  "date_to": "2025-06-05"
}
```

#### Response Format

##### Success Response (200 OK)
```json
{
  "success": true,
  "message": "Booking engine search test completed successfully (no data saved)",
  "data": {
    "days_recorded": 4,
    "subhotel_id": 123,
    "date_from": "2025-06-01",
    "date_to": "2025-06-05",
    "test_mode": true,
    "would_insert": [
      {
        "date": "2025-06-01",
        "subhotel_id": 123,
        "created_at": "2025-05-22 10:30:45"
      },
      {
        "date": "2025-06-02",
        "subhotel_id": 123,
        "created_at": "2025-05-22 10:30:45"
      }
    ]
  }
}
```

---

### Integration Guide

#### Step 1: Setup
Ensure you have the proper third-party token for your environment and that your domain is registered in the system.

#### Step 2: Implementation
For detailed implementation examples in various programming languages, please see:

**[üìÅ View Code Examples](./examples/)**

The examples folder contains implementation samples for:
- JavaScript
- TypeScript
- PHP
- Python

#### Step 3: Error Handling
Always implement proper error handling to manage different response scenarios:

- **Authentication errors**: Missing or invalid third-party token
- **URL validation errors**: Request origin doesn't match registered domain
- **Validation errors**: Display user-friendly messages for invalid dates
- **Server errors**: Show generic error message and retry mechanism

#### Important Notes
- All requests are logged by the middleware for audit purposes
- URL validation may be enforced depending on third-party configuration
- Ensure requests are made from registered domains if URL validation is enabled
- Sensitive data in request bodies (passwords, tokens) are automatically masked in logs

### Rate Limiting
- Maximum 100 requests per minute per IP address
- Bulk operations are recommended for multiple searches

### Best Practices
1. **Date Validation**: Always validate dates on the client side before sending requests
2. **Error Handling**: Implement comprehensive error handling for all possible scenarios
3. **Logging**: Log successful searches for your own analytics
4. **Retry Logic**: Implement exponential backoff for failed requests

### Additional Information

#### Support
For technical support, please contact: hello@peaqplus.com

#### API Versioning
Current version: v1

#### Changelog
- v1.0.0: Initial release

---

## Magyar Dokument√°ci√≥

### √Åttekint√©s
A Sz√°ll√°s Foglal√°si Motor API v√©gpontokat biztos√≠t a keres√©si tev√©kenys√©gek r√∂gz√≠t√©s√©hez sz√°llodai foglal√°si rendszerekben. Ez az API seg√≠t nyomon k√∂vetni a felhaszn√°l√≥i keres√©si viselked√©st elemz√©si √©s jelent√©sk√©sz√≠t√©si c√©lokb√≥l.

### URL
```
https://peaqplus.com/api
```

### Hiteles√≠t√©s
Minden k√©r√©s megfelel≈ë harmadik f√©l token hiteles√≠t√©st ig√©nyel a header-ben:
```
X-Third-Party-Token: YOUR_THIRD_PARTY_TOKEN
```

A middleware valid√°lja a tokent √©s automatikusan kinyeri a subhotel_id √©s harmadik f√©l inform√°ci√≥kat a tokenb≈ël. A rendszer URL valid√°ci√≥t is v√©gez, ha az enged√©lyezve van a harmadik f√©l sz√°m√°ra.

---

### POST /booking-engine-search

R√∂gz√≠ti a keres√©si tev√©kenys√©geket a foglal√°si motor rendszer√©ben elemz√©si √©s nyomon k√∂vet√©si c√©lokb√≥l.

#### V√©gpont
```
POST /api/booking-engine-search
```

#### K√©r√©s Param√©terei

| Param√©ter | T√≠pus | K√∂telez≈ë | Le√≠r√°s |
|-----------|-------|----------|---------|
| `date_from` | string | Igen | Bejelentkez√©s d√°tuma YYYY-MM-DD form√°tumban |
| `date_to` | string | Igen | Kijelentkez√©s d√°tuma YYYY-MM-DD form√°tumban (date_from ut√°n vagy azzal egyenl≈ë kell legyen) |

#### K√©r√©s P√©lda
```json
{
  "date_from": "2025-06-01",
  "date_to": "2025-06-05"
}
```

#### V√°lasz Form√°tum

##### Sikeres V√°lasz (200 OK)
```json
{
  "success": true,
  "message": "Booking engine search recorded successfully",
  "data": {
    "days_recorded": 4,
    "subhotel_id": 123,
    "date_from": "2025-06-01",
    "date_to": "2025-06-05"
  }
}
```

##### Hiba V√°laszok

**Hiteles√≠t√©si Hiba (401 Unauthorized)**
```json
{
  "success": false,
  "message": "Third party token is missing"
}
```

**√ârv√©nytelen Token (401 Unauthorized)**
```json
{
  "success": false,
  "message": "Invalid third party token"
}
```

**URL Valid√°ci√≥s Hiba (401 Unauthorized)**
```json
{
  "success": false,
  "message": "URL validation failed: missing referer or origin"
}
```

**Valid√°ci√≥s Hiba (422 Unprocessable Entity)**
```json
{
  "success": false,
  "message": "The given data was invalid.",
  "errors": {
    "date_from": ["The date from field is required."],
    "date_to": ["The date to must be a date after or equal to date from."]
  }
}
```

**Hi√°nyz√≥ Subhotel ID (400 Bad Request)**
```json
{
  "success": false,
  "message": "Invalid subhotel_id"
}
```

**Szerver Hiba (500 Internal Server Error)**
```json
{
  "success": false,
  "message": "Error processing booking engine search",
  "error": "Database connection failed"
}
```

---

### POST /test/booking-engine-search

Teszt v√©gpont, amely ut√°nozza a keres√©s r√∂gz√≠t√©si funkcionalit√°st an√©lk√ºl, hogy adatokat mentene az adatb√°zisba. Tesztel√©si √©s fejleszt√©si c√©lokra haszn√°latos.

#### V√©gpont
```
POST /api/test/booking-engine-search
```

#### K√©r√©s Param√©terei

| Param√©ter | T√≠pus | K√∂telez≈ë | Le√≠r√°s |
|-----------|-------|----------|---------|
| `date_from` | string | Igen | Bejelentkez√©s d√°tuma YYYY-MM-DD form√°tumban |
| `date_to` | string | Igen | Kijelentkez√©s d√°tuma YYYY-MM-DD form√°tumban (date_from ut√°n vagy azzal egyenl≈ë kell legyen) |

#### K√©r√©s P√©lda
```json
{
  "date_from": "2025-06-01",
  "date_to": "2025-06-05"
}
```

#### V√°lasz Form√°tum

##### Sikeres V√°lasz (200 OK)
```json
{
  "success": true,
  "message": "Booking engine search test completed successfully (no data saved)",
  "data": {
    "days_recorded": 4,
    "subhotel_id": 123,
    "date_from": "2025-06-01",
    "date_to": "2025-06-05",
    "test_mode": true,
    "would_insert": [
      {
        "date": "2025-06-01",
        "subhotel_id": 123,
        "created_at": "2025-05-22 10:30:45"
      },
      {
        "date": "2025-06-02",
        "subhotel_id": 123,
        "created_at": "2025-05-22 10:30:45"
      }
    ]
  }
}
```

---

### Integr√°ci√≥ √ötmutat√≥

#### 1. l√©p√©s: Be√°ll√≠t√°s
Gy≈ëz≈ëdj√∂n meg r√≥la, hogy rendelkezik a megfelel≈ë harmadik f√©l tokennel a k√∂rnyezet√©hez, √©s hogy a domain regisztr√°lva van a rendszerben.

#### 2. l√©p√©s: Implement√°ci√≥
R√©szletes implement√°ci√≥s p√©ld√°k√©rt k√ºl√∂nb√∂z≈ë programoz√°si nyelveken, k√©rj√ºk tekintse meg:

**[üìÅ K√≥d P√©ld√°k Megtekint√©se](./examples/)**

A p√©ld√°k mappa implement√°ci√≥s mint√°kat tartalmaz a k√∂vetkez≈ëkh√∂z:
- JavaScript
- TypeScript
- PHP
- Python

#### 3. l√©p√©s: Hibakezel√©s
Mindig implement√°ljon megfelel≈ë hibakezel√©st a k√ºl√∂nb√∂z≈ë v√°lasz forgat√≥k√∂nyvek kezel√©s√©hez:

- **Hiteles√≠t√©si hib√°k**: Hi√°nyz√≥ vagy √©rv√©nytelen harmadik f√©l token
- **URL valid√°ci√≥s hib√°k**: A k√©r√©s eredete nem egyezik a regisztr√°lt domain-nel
- **Valid√°ci√≥s hib√°k**: Felhaszn√°l√≥bar√°t √ºzenetek megjelen√≠t√©se √©rv√©nytelen d√°tumok eset√©n
- **Szerver hib√°k**: √Åltal√°nos hiba√ºzenet megjelen√≠t√©se √©s √∫jrapr√≥b√°lkoz√°si mechanizmus

#### Fontos Megjegyz√©sek
- Minden k√©r√©s napl√≥z√°sra ker√ºl a middleware √°ltal audit c√©lokra
- URL valid√°ci√≥ a harmadik f√©l konfigur√°ci√≥j√°t√≥l f√ºgg≈ëen lehet k√∂telez≈ë
- Gy≈ëz≈ëdj√∂n meg r√≥la, hogy a k√©r√©sek regisztr√°lt domain-ekr≈ël √©rkeznek, ha az URL valid√°ci√≥ enged√©lyezve van
- A k√©r√©s t√∂rzs√©ben l√©v≈ë √©rz√©keny adatok (jelszavak, tokenek) automatikusan maszkolt form√°ban ker√ºlnek napl√≥z√°sra

### Sebess√©g Korl√°toz√°s
- Maximum 100 k√©r√©s percenk√©nt IP c√≠menk√©nt
- T√∂meges m≈±veletek aj√°nlottak t√∂bb keres√©shez

### Legjobb Gyakorlatok
1. **D√°tum Valid√°ci√≥**: Mindig valid√°lja a d√°tumokat a kliens oldalon a k√©r√©sek elk√ºld√©se el≈ëtt
2. **Hibakezel√©s**: √Åtfog√≥ hibakezel√©st implement√°ljon minden lehets√©ges forgat√≥k√∂nyvh√∂z
3. **Napl√≥z√°s**: Napl√≥zza a sikeres keres√©seket saj√°t elemz√©si c√©lokra
4. **√öjrapr√≥b√°lkoz√°si Logika**: Exponenci√°lis visszatart√°st implement√°ljon sikertelen k√©r√©sekhez

### Tov√°bbi Inform√°ci√≥k

#### T√°mogat√°s
Technikai t√°mogat√°s√©rt forduljon ide: hello@peaqplus.com

#### API Verzi√≥kezel√©s
Jelenlegi verzi√≥: v1

#### V√°ltoz√°snapl√≥
- v1.0.0: Els≈ë kiad√°s

---

[‚¨ÜÔ∏è Back to Language Selection / Vissza a Nyelv V√°laszt√°shoz](#language-selection--nyelv-v√°laszt√°s)
